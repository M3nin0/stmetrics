

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>1. Spatio-tempoal Metrics &mdash; stmetrics 0.1.5.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="2. Benchmark" href="Benchmark.html" />
    <link rel="prev" title="Contributors" href="../contributors.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> stmetrics
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../metrics.html">Metric module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../polar.html">Polar metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../basics.html">Basic metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fractal.html">Fractal metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../spatial.html">Spatial Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../utils.html">Utility functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributors.html">Contributors</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">1. Spatio-tempoal Metrics </a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Getting-started">1.1. Getting started</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Import-test-image">1.2. Import test image</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Connect-to-BDC-stac">1.3. Connect to BDC-stac</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Time-Series-extraction">1.4. Time Series extraction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Polar-plot">1.5. Polar plot</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Metrics-computation">1.6. Metrics computation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Image-Metrics">1.7. Image Metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Now-let’s-plot-the-results!">1.8. Now let’s plot the results!</a></li>
<li class="toctree-l2"><a class="reference internal" href="#That’s-all!">1.9. That’s all!</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Benchmark.html">2. Benchmark</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">stmetrics</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>1. Spatio-tempoal Metrics </li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/examples/TimeMetrics.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Spatio-tempoal-Metrics-31dd42fa7f474105ab58c85fae792d1a">
<h1>1. Spatio-tempoal Metrics <img alt="Brazil Data Cube" src="http://brazildatacube.org/wp-content/uploads/slider2/datacube-site.png" /><a class="headerlink" href="#Spatio-tempoal-Metrics-31dd42fa7f474105ab58c85fae792d1a" title="Permalink to this headline">¶</a></h1>
<hr class="docutils" />
<p>In this notebook, we present some functionalities to perform Geographic Object Image Analysis (GEOBIA) with Earth Observation Data Cubes produced by the <a class="reference external" href="http://brazildatacube.org/">Brazil Data Cube (BDC) project</a> using the <a class="reference external" href="https://readthedocs.org/projects/stmetrics/">STMETRICS</a> package.</p>
<p>This notebook was designed to present some functionalities of the <strong>stmetrics</strong> python package. It provides the state-of-the-art features extraction methods for Satellite Image Time Series (SITS) that can be used for remote sensing time-series image classification and analysis.</p>
<p>Produce reliable land use and land cover maps to support the deployment and operation of public policies is a necessity, especially when environmental management and economic development are considered. To increase the accuracy of these maps, satellite image time-series have been used, as they allow the understanding of land cover dynamics through the time.</p>
<div class="section" id="Getting-started">
<h2>1.1. Getting started<a class="headerlink" href="#Getting-started" title="Permalink to this headline">¶</a></h2>
<p>Our first step is to install the <strong>``stmetrics``</strong>. To do this you can easily run</p>
<p><code class="docutils literal notranslate"><span class="pre">!pip</span> <span class="pre">install</span> <span class="pre">git+https://github.com/brazil-data-cube/stmetrics</span></code></p>
<p>Moreover, to use the datacube produced by the BDC project we need to install the <code class="docutils literal notranslate"><span class="pre">stac.py</span></code> package. You can do it using pip.</p>
<p><code class="docutils literal notranslate"><span class="pre">!pip</span> <span class="pre">install</span> <span class="pre">stac.py</span></code></p>
<p>!pip install E:<span class="math">\dados</span>_dos_usuarios_deste_servidor:nbsphinx-math:<cite>Anderson</cite><span class="math">\DataCube</span><span class="math">\Python</span>:nbsphinx-math:<a href="#id1"><span class="problematic" id="id2">`</span></a>stmetrics <a href="#id3"><span class="problematic" id="id4">`</span></a>–upgrade</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#import modules</span>
<span class="kn">import</span> <span class="nn">stac</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">pandas</span>
<span class="kn">import</span> <span class="nn">rasterio</span>
<span class="kn">import</span> <span class="nn">stmetrics</span>
<span class="kn">import</span> <span class="nn">multiprocessing</span> <span class="k">as</span> <span class="nn">mp</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1">#This is just to remove some annoying possible warnings</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Import-test-image">
<h2>1.2. Import test image<a class="headerlink" href="#Import-test-image" title="Permalink to this headline">¶</a></h2>
<p>Our test image is one of the datacubes produced by the Brazil Data Cube Project. To access the project products we will use the <code class="docutils literal notranslate"><span class="pre">stac.py</span></code> package. It can be installed using pip.</p>
<p><code class="docutils literal notranslate"><span class="pre">!pip</span> <span class="pre">install</span> <span class="pre">stac.py</span></code></p>
<p>Along with stac we must use some utility function to build a small datacube for our test. For this we use the following functions:</p>
<hr class="docutils" />
<p>Hint: the <strong>stmetrics</strong> package uses <em>numpy</em>, <em>rasterio</em> and <em>geopandas</em> in most of its functions. Use help or check the documentation to undestand it better <a class="reference external" href="https://stmetrics.readthedocs.io/en/latest/">https://stmetrics.readthedocs.io/en/latest/</a>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">xarray</span>

<span class="k">def</span> <span class="nf">longlat2window</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">dataset</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">        lon (tuple): Tuple of min and max lon</span>
<span class="sd">        lat (tuple): Tuple of min and max lat</span>
<span class="sd">        dataset: Rasterio dataset</span>

<span class="sd">    Returns:</span>
<span class="sd">        rasterio.windows.Window</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">pyproj</span> <span class="kn">import</span> <span class="n">Proj</span>

    <span class="kn">from</span> <span class="nn">rasterio.warp</span> <span class="kn">import</span> <span class="n">transform</span>
    <span class="kn">from</span> <span class="nn">rasterio.windows</span> <span class="kn">import</span> <span class="n">Window</span>

    <span class="n">p</span> <span class="o">=</span> <span class="n">Proj</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">crs</span><span class="p">)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">transform</span>
    <span class="n">xmin</span><span class="p">,</span> <span class="n">ymin</span> <span class="o">=</span> <span class="n">p</span><span class="p">(</span><span class="n">lon</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lat</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">xmax</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="n">p</span><span class="p">(</span><span class="n">lon</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">lat</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">col_min</span><span class="p">,</span> <span class="n">row_min</span> <span class="o">=</span> <span class="o">~</span><span class="n">t</span> <span class="o">*</span> <span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">ymin</span><span class="p">)</span>
    <span class="n">col_max</span><span class="p">,</span> <span class="n">row_max</span> <span class="o">=</span> <span class="o">~</span><span class="n">t</span> <span class="o">*</span> <span class="p">(</span><span class="n">xmax</span><span class="p">,</span> <span class="n">ymax</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Window</span><span class="o">.</span><span class="n">from_slices</span><span class="p">(</span><span class="n">rows</span><span class="o">=</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">row_max</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">row_min</span><span class="p">)),</span>
                              <span class="n">cols</span><span class="o">=</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">col_min</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">col_max</span><span class="p">)))</span>

<span class="k">def</span> <span class="nf">file_to_da</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="n">bbox</span><span class="p">,</span> <span class="n">crop</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="kn">import</span> <span class="nn">re</span>
    <span class="kn">import</span> <span class="nn">numpy</span>
    <span class="kn">import</span> <span class="nn">pandas</span>
    <span class="kn">import</span> <span class="nn">rasterio</span>
    <span class="kn">import</span> <span class="nn">xarray</span>
    <span class="kn">from</span> <span class="nn">affine</span> <span class="kn">import</span> <span class="n">Affine</span>
    <span class="kn">from</span> <span class="nn">rasterio.warp</span> <span class="kn">import</span> <span class="n">transform</span>

    <span class="c1">#Open image as xarray.DataArray</span>
    <span class="n">da</span> <span class="o">=</span> <span class="n">xarray</span><span class="o">.</span><span class="n">open_rasterio</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>

    <span class="c1">#find datetime</span>
    <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\d</span><span class="si">{4}</span><span class="s1">-\d</span><span class="si">{2}</span><span class="s1">-\d</span><span class="si">{2}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">filepath</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">da</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">match</span>

    <span class="c1"># Compute the lon/lat coordinates and build meshgrid</span>
    <span class="n">ny</span><span class="p">,</span> <span class="n">nx</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">da</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]),</span> <span class="nb">len</span><span class="p">(</span><span class="n">da</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">])</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">da</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span> <span class="n">da</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">])</span>

    <span class="c1"># Rasterio works with 1D arrays</span>
    <span class="n">lon</span><span class="p">,</span> <span class="n">lat</span> <span class="o">=</span> <span class="n">transform</span><span class="p">(</span><span class="n">da</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;init&#39;</span><span class="p">:</span> <span class="s1">&#39;EPSG:4326&#39;</span><span class="p">},</span> <span class="n">x</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">y</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span>
    <span class="n">lon</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">lon</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">ny</span><span class="p">,</span> <span class="n">nx</span><span class="p">))</span>
    <span class="n">lat</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">lat</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">ny</span><span class="p">,</span> <span class="n">nx</span><span class="p">))</span>

    <span class="c1">#add spatial coordinates to xarray</span>
    <span class="n">da</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">lon</span><span class="p">)</span>
    <span class="n">da</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">lat</span><span class="p">)</span>

    <span class="c1">#Crop xarray if requested</span>
    <span class="k">if</span> <span class="n">crop</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>

        <span class="c1">#Get coordinates</span>
        <span class="n">w</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">n</span>  <span class="o">=</span> <span class="n">bbox</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>

        <span class="c1">#To crop we just use where over lat/long</span>
        <span class="n">mask_lon</span> <span class="o">=</span> <span class="p">(</span><span class="n">da</span><span class="o">.</span><span class="n">lon</span> <span class="o">&gt;=</span> <span class="nb">float</span><span class="p">(</span><span class="n">w</span><span class="p">))</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">da</span><span class="o">.</span><span class="n">lon</span> <span class="o">&lt;=</span> <span class="nb">float</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
        <span class="n">mask_lat</span> <span class="o">=</span> <span class="p">(</span><span class="n">da</span><span class="o">.</span><span class="n">lat</span> <span class="o">&gt;=</span> <span class="nb">float</span><span class="p">(</span><span class="n">s</span><span class="p">))</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">da</span><span class="o">.</span><span class="n">lat</span> <span class="o">&lt;=</span> <span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>

        <span class="c1">#get cropped xarray.DataArray</span>
        <span class="n">da</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mask_lon</span> <span class="o">&amp;</span> <span class="n">mask_lat</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">da</span>

<span class="k">def</span> <span class="nf">bdc2xray</span><span class="p">(</span><span class="n">stac</span><span class="p">,</span> <span class="n">collection</span><span class="p">,</span> <span class="n">bbox</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">bands</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ndvi&#39;</span><span class="p">]):</span>

    <span class="n">box</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">bbox</span><span class="p">)</span>

    <span class="n">collection</span> <span class="o">=</span> <span class="n">stac</span><span class="o">.</span><span class="n">collection</span><span class="p">(</span><span class="n">collection</span><span class="p">)</span>
    <span class="n">items</span> <span class="o">=</span> <span class="n">collection</span><span class="o">.</span><span class="n">get_items</span><span class="p">(</span><span class="nb">filter</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;bbox&#39;</span><span class="p">:</span><span class="n">box</span><span class="p">,</span><span class="s1">&#39;datetime&#39;</span><span class="p">:</span><span class="n">time</span><span class="p">,</span> <span class="s1">&#39;limit&#39;</span><span class="p">:</span><span class="mi">1000</span><span class="p">})</span>

    <span class="n">list_of_datasets</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">dataset</span> <span class="o">=</span> <span class="n">xarray</span><span class="o">.</span><span class="n">Dataset</span><span class="p">()</span>

    <span class="c1">#get links to images in Brazil Data Cube</span>
    <span class="k">for</span> <span class="n">band</span> <span class="ow">in</span> <span class="n">bands</span><span class="p">:</span>

        <span class="n">list_of_data_arrays</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="o">.</span><span class="n">features</span><span class="p">)):</span>
            <span class="n">dataarray</span> <span class="o">=</span> <span class="n">file_to_da</span><span class="p">(</span><span class="n">items</span><span class="o">.</span><span class="n">features</span><span class="p">[</span><span class="n">item</span><span class="p">]</span><span class="o">.</span><span class="n">assets</span><span class="p">[</span><span class="n">band</span><span class="p">][</span><span class="s1">&#39;href&#39;</span><span class="p">],</span> <span class="n">box</span> <span class="p">)</span>
            <span class="n">list_of_data_arrays</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dataarray</span><span class="p">)</span>

        <span class="n">dataset</span><span class="p">[</span><span class="n">band</span><span class="p">]</span> <span class="o">=</span> <span class="n">xarray</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">list_of_data_arrays</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>

        <span class="c1">#load xarray</span>
        <span class="n">list_of_datasets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>

    <span class="n">bdc_xray</span> <span class="o">=</span> <span class="n">xarray</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">list_of_datasets</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">bdc_xray</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Connect-to-BDC-stac">
<h2>1.3. Connect to BDC-stac<a class="headerlink" href="#Connect-to-BDC-stac" title="Permalink to this headline">¶</a></h2>
<p>Our first step is obtain a datacube, here we will use one of the datacubes produced by the <strong>BDC project</strong>. To do so, we will use the stac service provided by the project and the <code class="docutils literal notranslate"><span class="pre">stac.py</span></code> package, which is also developed by the BDC team.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">bdc_stac</span> <span class="o">=</span> <span class="n">stac</span><span class="o">.</span><span class="n">STAC</span><span class="p">(</span><span class="s2">&quot;http://brazildatacube.dpi.inpe.br/stac/&quot;</span><span class="p">)</span>
<span class="n">bdc_stac</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<p>STAC</p>
                    <ul>
                     <li><b>URL:</b> http://brazildatacube.dpi.inpe.br/stac/</li>
                     <li><b>Collections:</b></li>
                     <ul>
                     <li>LC8_30-1</li><li>S2TOA-1</li><li>HLS.S30-1</li><li>MYD13Q1-1</li><li>HLS.L30-1</li><li>LC8DN-1</li><li>LC8SR-1</li><li>L5SR-1</li><li>S2_10-1</li><li>MOD13Q1-1</li><li>S2_MSI_L2_SR_LASRC-1</li><li>CB4_64-1</li><li>S2_10_16D_STK-1</li><li>LC8_30_16D_STK-1</li><li>CB4_64_16D_STK-1</li>
                     </ul>
                   </ul></div>
</div>
<p>The above result display the list of collections and datacube available.</p>
<p>Now let’s define a bouding box of our interest area. This one is located in the MATOPIBA region in Brazil. For simplication purpose, for this test only NDVI will be used.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">w</span> <span class="o">=</span> <span class="o">-</span><span class="mf">45.90</span>
<span class="n">n</span> <span class="o">=</span> <span class="o">-</span><span class="mf">12.20</span>
<span class="n">e</span> <span class="o">=</span> <span class="o">-</span><span class="mf">45.20</span>
<span class="n">s</span> <span class="o">=</span> <span class="o">-</span><span class="mf">12.90</span>
<span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span> <span class="n">w</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">e</span><span class="p">,</span><span class="n">n</span> <span class="p">)</span>

<span class="n">my_bands</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;NDVI&#39;</span><span class="p">]</span>
<span class="n">timeline</span> <span class="o">=</span> <span class="s1">&#39;2018-09-01/2019-08-31&#39;</span>
</pre></div>
</div>
</div>
<p>Now we will use the utility functions available above to create an <strong>xarray.Dataset</strong> using <code class="docutils literal notranslate"><span class="pre">stac.py</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">xarray</span> <span class="o">=</span> <span class="n">bdc2xray</span><span class="p">(</span><span class="n">bdc_stac</span><span class="p">,</span> <span class="s2">&quot;CB4_64_16D_STK-1&quot;</span><span class="p">,</span> <span class="n">bbox</span><span class="p">,</span> <span class="n">timeline</span><span class="p">,</span> <span class="n">my_bands</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Let’s plot the xarray</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">xarray</span><span class="o">.</span><span class="n">NDVI</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;lon&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;lat&quot;</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="n">col_wrap</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;xarray.plot.facetgrid.FacetGrid at 0xf72bf48&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_TimeMetrics_13_1.png" src="../_images/examples_TimeMetrics_13_1.png" />
</div>
</div>
<p>Now lets select some sample points to be used in our examples.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">img</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">xarray</span><span class="o">.</span><span class="n">NDVI</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">fig</span><span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>  <span class="c1"># width, height in inches</span>
<span class="n">sub</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">sub</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">[</span><span class="mi">0</span><span class="p">,:,:],</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="mi">1100</span><span class="p">,</span><span class="mi">185</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span><span class="mi">800</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Class: Natural Vegetation - Date 0&#39;</span><span class="p">)</span>
<span class="n">sub</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">sub</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">[</span><span class="mi">0</span><span class="p">,:,:],</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="mi">450</span><span class="p">,</span><span class="mi">350</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="mi">730</span><span class="p">,</span><span class="mi">140</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Class: Agriculture - Date 0&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_TimeMetrics_15_0.png" src="../_images/examples_TimeMetrics_15_0.png" />
</div>
</div>
</div>
<div class="section" id="Time-Series-extraction">
<h2>1.4. Time Series extraction<a class="headerlink" href="#Time-Series-extraction" title="Permalink to this headline">¶</a></h2>
<p>Now let’s use our “samples” to extract some time series profiles.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">matplotlib.dates</span> <span class="k">as</span> <span class="nn">mdates</span>

<span class="n">fn</span> <span class="o">=</span> <span class="n">img</span><span class="p">[:,</span><span class="mi">1100</span><span class="p">,</span><span class="mi">185</span><span class="p">]</span> <span class="c1">#Natural vegetation</span>
<span class="n">agr</span> <span class="o">=</span> <span class="n">img</span><span class="p">[:,</span><span class="mi">450</span><span class="p">,</span><span class="mi">350</span><span class="p">]</span> <span class="c1">#Agriculture pattern</span>

<span class="c1">#get dates from xarray</span>
<span class="n">dates</span> <span class="o">=</span> <span class="n">xarray</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">values</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dates</span><span class="p">,</span><span class="n">fn</span><span class="p">,</span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="s1">&#39;Natural Vegetation&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">dates</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dates</span><span class="p">,</span><span class="n">agr</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;m&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="s1">&#39;Agriculture&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">dates</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_TimeMetrics_17_0.png" src="../_images/examples_TimeMetrics_17_0.png" />
</div>
</div>
</div>
<div class="section" id="Polar-plot">
<h2>1.5. Polar plot<a class="headerlink" href="#Polar-plot" title="Permalink to this headline">¶</a></h2>
<p>The stmetrics is currently composed by 4 modules:</p>
<ul class="simple">
<li><p>Metrics - With some functions to compute the all metrics available</p></li>
<li><p>Basics - That has the implementation of the basics metrics</p></li>
<li><p>Polar - That has the implementation of the polar metrics proposed by Körting (2013).</p></li>
<li><p>Fractal - That has the implementatio of fractal metrics that are currently under assessment.</p></li>
</ul>
<p>The polar approach proposed by Körting (2013) convert the time series to a polar coordinate system. This way we can plot the series in this space just to look at it and get some insights about the time series. For this, we can use the funtion <code class="docutils literal notranslate"><span class="pre">polar_plot</span></code>.</p>
<p>The plot as you will see is composed by the series over four quadrants. The idea here is observe a stronger response over a specific period. Imagine that your time series encompass a year of observations, this way each quadrant represents 3 months.</p>
<p><img alt="Polar plot representation." src="https://drive.google.com/uc?export=view&amp;id=1IFFXSFtNNZJ4L_ihfnRgBTD6jRf4puoD" /></p>
<blockquote>
<div><p>Reference: Körting, Thales &amp; Câmara, Gilberto &amp; Fonseca, Leila. (2013).Land Cover Detection Using Temporal Features Based On Polar Representation.</p>
</div></blockquote>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#Plotting our time series samples</span>
<span class="c1">#Natural Vegetation</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Natural Vegetation&#39;</span><span class="p">)</span>
<span class="n">stmetrics</span><span class="o">.</span><span class="n">polar</span><span class="o">.</span><span class="n">polar_plot</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Agriculture&#39;</span><span class="p">)</span>
<span class="c1">#Pasture</span>
<span class="n">stmetrics</span><span class="o">.</span><span class="n">polar</span><span class="o">.</span><span class="n">polar_plot</span><span class="p">(</span><span class="n">agr</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Natural Vegetation
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_TimeMetrics_19_1.png" src="../_images/examples_TimeMetrics_19_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Agriculture
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_TimeMetrics_19_3.png" src="../_images/examples_TimeMetrics_19_3.png" />
</div>
</div>
</div>
<div class="section" id="Metrics-computation">
<h2>1.6. Metrics computation<a class="headerlink" href="#Metrics-computation" title="Permalink to this headline">¶</a></h2>
<p>The stmetrics has two functions to compute the metrics. The <code class="docutils literal notranslate"><span class="pre">get_metrics</span></code> function was designed to be used for compute the metrics of one time series. Along with the metrics, using the function you can also see the polar plot. Just remember, one series each time.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">sits2metrics</span></code> function was developed to compute the metrics over images, as the name states. For this function we use multiprocessing package to improve perfomance. Don’t worry if it is using the whole campacity of your system, it was designed to do it.</p>
<hr class="docutils" />
<blockquote>
<div><p><strong>NOTE:</strong> This process may take sometime, tha package is computing <strong>28 metrics!</strong></p>
</div></blockquote>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">im_metrics</span> <span class="o">=</span> <span class="n">stmetrics</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">sits2metrics</span><span class="p">(</span><span class="n">xarray</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">im_metrics</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt, dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:       (band: 1, metric: 28, time: 24, x: 1207, y: 1263)
Coordinates:
  * band          (band) int32 1
  * y             (y) float64 9.965e+06 9.965e+06 ... 9.884e+06 9.884e+06
  * x             (x) float64 5.866e+06 5.866e+06 ... 5.943e+06 5.943e+06
  * time          (time) object &#x27;2019-09-13&#x27; &#x27;2019-08-28&#x27; ... &#x27;2018-09-13&#x27;
    lon           (y, x) float64 -45.92 -45.92 -45.92 ... -45.18 -45.18 -45.18
    lat           (y, x) float64 -12.2 -12.2 -12.2 -12.2 ... -12.9 -12.9 -12.9
  * metric        (metric) object &#x27;max_ts&#x27; &#x27;min_ts&#x27; ... &#x27;hurst_exp&#x27; &#x27;katz_fd&#x27;
Data variables:
    NDVI          (time, band, y, x) float64 nan nan nan nan ... nan nan nan nan
    NDVI_metrics  (metric, y, x) float64 nan nan nan nan nan ... nan nan nan nan</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-9186f8dc-9f25-49cc-9931-83dac7bc7fd4' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-9186f8dc-9f25-49cc-9931-83dac7bc7fd4' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>band</span>: 1</li><li><span class='xr-has-index'>metric</span>: 28</li><li><span class='xr-has-index'>time</span>: 24</li><li><span class='xr-has-index'>x</span>: 1207</li><li><span class='xr-has-index'>y</span>: 1263</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-34eefcd9-1f61-4633-8570-132f75e4e1e3' class='xr-section-summary-in' type='checkbox'  checked><label for='section-34eefcd9-1f61-4633-8570-132f75e4e1e3' class='xr-section-summary' >Coordinates: <span>(7)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>band</span></div><div class='xr-var-dims'>(band)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>1</div><input id='attrs-e1c6682a-5bb0-4145-af87-2083b5536dcf' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e1c6682a-5bb0-4145-af87-2083b5536dcf' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-986ceb76-1e98-4185-97bf-9e8fea532096' class='xr-var-data-in' type='checkbox'><label for='data-986ceb76-1e98-4185-97bf-9e8fea532096' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([1])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>9.965e+06 9.965e+06 ... 9.884e+06</div><input id='attrs-e6073374-4046-434a-8771-cb71ddfcb95b' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e6073374-4046-434a-8771-cb71ddfcb95b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5ad3f8d2-6b6e-428b-b787-e5a3a9dce85d' class='xr-var-data-in' type='checkbox'><label for='data-5ad3f8d2-6b6e-428b-b787-e5a3a9dce85d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([9964930.869096, 9964866.866757, 9964802.864417, ..., 9884287.921334,
       9884223.918995, 9884159.916655])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>5.866e+06 5.866e+06 ... 5.943e+06</div><input id='attrs-eb012020-30b3-4c4a-84ec-f423cf5f8d4b' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-eb012020-30b3-4c4a-84ec-f423cf5f8d4b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9684eb84-606b-44ca-81f2-8abb556f3587' class='xr-var-data-in' type='checkbox'><label for='data-9684eb84-606b-44ca-81f2-8abb556f3587' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([5865778.261905, 5865842.25925 , 5865906.256595, ..., 5942831.06544 ,
       5942895.062785, 5942959.06013 ])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>&#x27;2019-09-13&#x27; ... &#x27;2018-09-13&#x27;</div><input id='attrs-9cdbd395-0cb7-4226-aa37-aa17f161f3d3' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-9cdbd395-0cb7-4226-aa37-aa17f161f3d3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-27cebdce-769b-4f22-a948-fc9bc7ac6228' class='xr-var-data-in' type='checkbox'><label for='data-27cebdce-769b-4f22-a948-fc9bc7ac6228' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;2019-09-13&#x27;, &#x27;2019-08-28&#x27;, &#x27;2019-08-12&#x27;, &#x27;2019-07-27&#x27;, &#x27;2019-07-11&#x27;,
       &#x27;2019-06-25&#x27;, &#x27;2019-06-09&#x27;, &#x27;2019-05-24&#x27;, &#x27;2019-05-08&#x27;, &#x27;2019-04-22&#x27;,
       &#x27;2019-04-06&#x27;, &#x27;2019-03-21&#x27;, &#x27;2019-03-05&#x27;, &#x27;2019-02-17&#x27;, &#x27;2019-02-01&#x27;,
       &#x27;2019-01-16&#x27;, &#x27;2018-12-31&#x27;, &#x27;2018-12-18&#x27;, &#x27;2018-12-02&#x27;, &#x27;2018-11-16&#x27;,
       &#x27;2018-10-31&#x27;, &#x27;2018-10-15&#x27;, &#x27;2018-09-29&#x27;, &#x27;2018-09-13&#x27;], dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lon</span></div><div class='xr-var-dims'>(y, x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-45.92 -45.92 ... -45.18 -45.18</div><input id='attrs-a53d57e1-822a-4935-9c64-76f4c8a3dd6a' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a53d57e1-822a-4935-9c64-76f4c8a3dd6a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-dbb138a6-63f7-4dd5-8b9f-fdb004355416' class='xr-var-data-in' type='checkbox'><label for='data-dbb138a6-63f7-4dd5-8b9f-fdb004355416' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[-45.92096364, -45.92036678, -45.91976992, ..., -45.20239765,
        -45.20180088, -45.20120411],
       [-45.9209464 , -45.92034953, -45.91975267, ..., -45.20237887,
        -45.2017821 , -45.20118533],
       [-45.92092915, -45.92033229, -45.91973543, ..., -45.2023601 ,
        -45.20176332, -45.20116655],
       ...,
       [-45.89917918, -45.89858071, -45.89798224, ..., -45.17867809,
        -45.17807971, -45.17748134],
       [-45.89916184, -45.89856337, -45.8979649 , ..., -45.17865921,
        -45.17806084, -45.17746246],
       [-45.8991445 , -45.89854603, -45.89794756, ..., -45.17864034,
        -45.17804196, -45.17744358]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lat</span></div><div class='xr-var-dims'>(y, x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-12.2 -12.2 -12.2 ... -12.9 -12.9</div><input id='attrs-6f70af63-ff0c-4a09-b3a3-508243a1660d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-6f70af63-ff0c-4a09-b3a3-508243a1660d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-613fe8a2-4108-4e84-b96a-6e61a2471487' class='xr-var-data-in' type='checkbox'><label for='data-613fe8a2-4108-4e84-b96a-6e61a2471487' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[-12.20091905, -12.2009026 , -12.20088614, ..., -12.18022986,
        -12.18021195, -12.18019403],
       [-12.20148863, -12.20147218, -12.20145573, ..., -12.18079941,
        -12.18078149, -12.18076357],
       [-12.20205822, -12.20204177, -12.20202531, ..., -12.18136895,
        -12.18135103, -12.18133312],
       ...,
       [-12.91859716, -12.91858066, -12.91856416, ..., -12.89785168,
        -12.89783372, -12.89781575],
       [-12.91916676, -12.91915026, -12.91913376, ..., -12.89842124,
        -12.89840327, -12.89838531],
       [-12.91973636, -12.91971986, -12.91970336, ..., -12.89899079,
        -12.89897283, -12.89895486]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>metric</span></div><div class='xr-var-dims'>(metric)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>&#x27;max_ts&#x27; &#x27;min_ts&#x27; ... &#x27;katz_fd&#x27;</div><input id='attrs-c7bf7def-5a64-4a4c-b9f8-30fd52f9caaa' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-c7bf7def-5a64-4a4c-b9f8-30fd52f9caaa' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2e9c41b8-5ffd-4a72-a700-f2daed15c1eb' class='xr-var-data-in' type='checkbox'><label for='data-2e9c41b8-5ffd-4a72-a700-f2daed15c1eb' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;max_ts&#x27;, &#x27;min_ts&#x27;, &#x27;mean_ts&#x27;, &#x27;std_ts&#x27;, &#x27;sum_ts&#x27;, &#x27;amplitude_ts&#x27;,
       &#x27;mse_ts&#x27;, &#x27;fslope_ts&#x27;, &#x27;skew_ts&#x27;, &#x27;amd_ts&#x27;, &#x27;abs_sum_ts&#x27;, &#x27;iqr_ts&#x27;,
       &#x27;fqr_ts&#x27;, &#x27;tqr_ts&#x27;, &#x27;sqr_ts&#x27;, &#x27;ecc_metric&#x27;, &#x27;gyration_radius&#x27;,
       &#x27;area_ts&#x27;, &#x27;polar_balance&#x27;, &#x27;angle&#x27;, &#x27;area_q1&#x27;, &#x27;area_q2&#x27;, &#x27;area_q3&#x27;,
       &#x27;area_q4&#x27;, &#x27;csi&#x27;, &#x27;dfa_fd&#x27;, &#x27;hurst_exp&#x27;, &#x27;katz_fd&#x27;], dtype=object)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-2e8248b6-93db-4df8-b102-5fe44fe318c1' class='xr-section-summary-in' type='checkbox'  checked><label for='section-2e8248b6-93db-4df8-b102-5fe44fe318c1' class='xr-section-summary' >Data variables: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>NDVI</span></div><div class='xr-var-dims'>(time, band, y, x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-baf223ce-ac63-48c9-b5aa-0194c9a2e004' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-baf223ce-ac63-48c9-b5aa-0194c9a2e004' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-14e96b60-9f6f-4e3d-82f5-2aa7720df0e8' class='xr-var-data-in' type='checkbox'><label for='data-14e96b60-9f6f-4e3d-82f5-2aa7720df0e8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>transform :</span></dt><dd>(63.9973451285607, 0.0, 5634843.84200847, 0.0, -64.00233949373292, 10096359.67324671)</dd><dt><span>crs :</span></dt><dd>+proj=aea +lat_1=-2 +lat_2=-22 +lat_0=-12 +lon_0=-54 +x_0=5000000 +y_0=10000000 +ellps=GRS80 +units=m +no_defs=True</dd><dt><span>res :</span></dt><dd>(63.9973451285607, 64.00233949373292)</dd><dt><span>is_tiled :</span></dt><dd>1</dd><dt><span>nodatavals :</span></dt><dd>(-9999.0,)</dd><dt><span>scales :</span></dt><dd>(1.0,)</dd><dt><span>offsets :</span></dt><dd>(0.0,)</dd><dt><span>AREA_OR_POINT :</span></dt><dd>Area</dd></dl></div><div class='xr-var-data'><pre>array([[[[nan, nan, nan, ..., nan, nan, nan],
         [nan, nan, nan, ..., nan, nan, nan],
         [nan, nan, nan, ..., nan, nan, nan],
         ...,
         [nan, nan, nan, ..., nan, nan, nan],
         [nan, nan, nan, ..., nan, nan, nan],
         [nan, nan, nan, ..., nan, nan, nan]]],


       [[[nan, nan, nan, ..., nan, nan, nan],
         [nan, nan, nan, ..., nan, nan, nan],
         [nan, nan, nan, ..., nan, nan, nan],
         ...,
         [nan, nan, nan, ..., nan, nan, nan],
         [nan, nan, nan, ..., nan, nan, nan],
         [nan, nan, nan, ..., nan, nan, nan]]],


       [[[nan, nan, nan, ..., nan, nan, nan],
         [nan, nan, nan, ..., nan, nan, nan],
...
         [nan, nan, nan, ..., nan, nan, nan],
         [nan, nan, nan, ..., nan, nan, nan]]],


       [[[nan, nan, nan, ..., nan, nan, nan],
         [nan, nan, nan, ..., nan, nan, nan],
         [nan, nan, nan, ..., nan, nan, nan],
         ...,
         [nan, nan, nan, ..., nan, nan, nan],
         [nan, nan, nan, ..., nan, nan, nan],
         [nan, nan, nan, ..., nan, nan, nan]]],


       [[[nan, nan, nan, ..., nan, nan, nan],
         [nan, nan, nan, ..., nan, nan, nan],
         [nan, nan, nan, ..., nan, nan, nan],
         ...,
         [nan, nan, nan, ..., nan, nan, nan],
         [nan, nan, nan, ..., nan, nan, nan],
         [nan, nan, nan, ..., nan, nan, nan]]]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>NDVI_metrics</span></div><div class='xr-var-dims'>(metric, y, x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-1aed96bc-2b95-4438-bd80-182bc01497bf' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-1aed96bc-2b95-4438-bd80-182bc01497bf' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b268bd62-cb4c-4dca-b768-050d1e5c1e88' class='xr-var-data-in' type='checkbox'><label for='data-b268bd62-cb4c-4dca-b768-050d1e5c1e88' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[nan, nan, nan, ..., nan, nan, nan],
        [nan, nan, nan, ..., nan, nan, nan],
        [nan, nan, nan, ..., nan, nan, nan],
        ...,
        [nan, nan, nan, ..., nan, nan, nan],
        [nan, nan, nan, ..., nan, nan, nan],
        [nan, nan, nan, ..., nan, nan, nan]],

       [[nan, nan, nan, ..., nan, nan, nan],
        [nan, nan, nan, ..., nan, nan, nan],
        [nan, nan, nan, ..., nan, nan, nan],
        ...,
        [nan, nan, nan, ..., nan, nan, nan],
        [nan, nan, nan, ..., nan, nan, nan],
        [nan, nan, nan, ..., nan, nan, nan]],

       [[nan, nan, nan, ..., nan, nan, nan],
        [nan, nan, nan, ..., nan, nan, nan],
        [nan, nan, nan, ..., nan, nan, nan],
        ...,
...
        ...,
        [nan, nan, nan, ..., nan, nan, nan],
        [nan, nan, nan, ..., nan, nan, nan],
        [nan, nan, nan, ..., nan, nan, nan]],

       [[nan, nan, nan, ..., nan, nan, nan],
        [nan, nan, nan, ..., nan, nan, nan],
        [nan, nan, nan, ..., nan, nan, nan],
        ...,
        [nan, nan, nan, ..., nan, nan, nan],
        [nan, nan, nan, ..., nan, nan, nan],
        [nan, nan, nan, ..., nan, nan, nan]],

       [[nan, nan, nan, ..., nan, nan, nan],
        [nan, nan, nan, ..., nan, nan, nan],
        [nan, nan, nan, ..., nan, nan, nan],
        ...,
        [nan, nan, nan, ..., nan, nan, nan],
        [nan, nan, nan, ..., nan, nan, nan],
        [nan, nan, nan, ..., nan, nan, nan]]])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-7e3e94ca-018a-4885-8582-ccae443e2441' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-7e3e94ca-018a-4885-8582-ccae443e2441' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div>
</div>
</div>
<div class="section" id="Image-Metrics">
<h2>1.7. Image Metrics<a class="headerlink" href="#Image-Metrics" title="Permalink to this headline">¶</a></h2>
<p>The output of <code class="docutils literal notranslate"><span class="pre">get_metrics</span></code> and <code class="docutils literal notranslate"><span class="pre">sits2metrics</span></code> follows the same order and can be acessed with the <code class="docutils literal notranslate"><span class="pre">list_metrics</span></code> function that is available at <code class="docutils literal notranslate"><span class="pre">utils</span></code> module.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">stmetrics</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">list_metrics</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;max_ts&#39;,
 &#39;min_ts&#39;,
 &#39;mean_ts&#39;,
 &#39;std_ts&#39;,
 &#39;sum_ts&#39;,
 &#39;amplitude_ts&#39;,
 &#39;mse_ts&#39;,
 &#39;fslope_ts&#39;,
 &#39;skew_ts&#39;,
 &#39;amd_ts&#39;,
 &#39;abs_sum_ts&#39;,
 &#39;iqr_ts&#39;,
 &#39;fqr_ts&#39;,
 &#39;tqr_ts&#39;,
 &#39;sqr_ts&#39;,
 &#39;ecc_metric&#39;,
 &#39;gyration_radius&#39;,
 &#39;area_ts&#39;,
 &#39;polar_balance&#39;,
 &#39;angle&#39;,
 &#39;area_q1&#39;,
 &#39;area_q2&#39;,
 &#39;area_q3&#39;,
 &#39;area_q4&#39;,
 &#39;csi&#39;,
 &#39;dfa_fd&#39;,
 &#39;hurst_exp&#39;,
 &#39;katz_fd&#39;]
</pre></div></div>
</div>
</div>
<div class="section" id="Now-let’s-plot-the-results!">
<h2>1.8. Now let’s plot the results!<a class="headerlink" href="#Now-let’s-plot-the-results!" title="Permalink to this headline">¶</a></h2>
<p>Don’t worry if some metric is too noise or you don’t see a clear pattern, some features are not always representative.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">header</span> <span class="o">=</span> <span class="n">stmetrics</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">list_metrics</span><span class="p">()</span>

<span class="n">img</span> <span class="o">=</span> <span class="n">im_metrics</span><span class="o">.</span><span class="n">NDVI_metrics</span><span class="o">.</span><span class="n">values</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">30</span><span class="p">))</span>

<span class="k">for</span> <span class="n">b</span><span class="p">,</span><span class="n">n</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">header</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">b</span><span class="p">,)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">[</span><span class="n">b</span><span class="o">-</span><span class="mi">1</span><span class="p">,:,:])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="mi">1100</span><span class="p">,</span><span class="mi">185</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span><span class="mi">800</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="mi">450</span><span class="p">,</span><span class="mi">350</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="mi">730</span><span class="p">,</span><span class="mi">140</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_TimeMetrics_26_0.png" src="../_images/examples_TimeMetrics_26_0.png" />
</div>
</div>
</div>
<div class="section" id="That’s-all!">
<h2>1.9. That’s all!<a class="headerlink" href="#That’s-all!" title="Permalink to this headline">¶</a></h2>
<p>Soon we will have more examples and usages to perform time series classifications.</p>
<p>Keep watching our repo on github <a class="reference external" href="https://github.com/brazil-data-cube/stmetrics">https://github.com/brazil-data-cube/stmetrics</a> and our documentation <a class="reference external" href="https://stmetrics.readthedocs.io/en/latest/">https://stmetrics.readthedocs.io/en/latest/</a>!</p>
<p>If you find any problems in the package, please, submit an issue on github.</p>
<p><strong>Thanks for checking!</strong></p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Benchmark.html" class="btn btn-neutral float-right" title="2. Benchmark" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../contributors.html" class="btn btn-neutral float-left" title="Contributors" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Brazil Data Cube

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>